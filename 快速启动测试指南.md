# 🚀 学生综合素质评价系统 - 快速启动测试指南

> 本指南帮助您快速启动系统并进行功能测试

---

## 📋 启动前准备

### 1. 确认环境依赖

```bash
# Python版本检查（需要3.9+）
python --version

# Node.js版本检查（需要16+）
node --version

# MySQL检查
mysql --version
```

### 2. 确认数据库已初始化

```bash
# 登录MySQL
mysql -u root -p

# 检查数据库
SHOW DATABASES LIKE 'calligraphy_ai';

# 检查表
USE calligraphy_ai;
SHOW TABLES;

# 退出
EXIT;
```

如果还没有初始化数据库，请运行：
```bash
mysql -u root -p calligraphy_ai < database/init_full.sql
```

---

## 🎬 快速启动步骤

### 步骤1: 启动后端服务

```bash
# Windows
cd /d "e:\python\yixiao-student-evaluate-system"
python run_web.py

# Linux/Mac
cd "/path/to/yixiao-student-evaluate-system"
python3 run_web.py
```

**预期输出**:
```
INFO:     Started server process
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000
```

✅ 后端启动成功！浏览器访问 `http://localhost:8000/docs` 可查看API文档

### 步骤2: 启动前端服务

**打开新的命令行窗口**:

```bash
# 进入前端目录
cd frontend

# 启动开发服务器
npm run dev
```

**预期输出**:
```
  VITE v5.x.x  ready in xxx ms

  ➜  Local:   http://localhost:3000/
  ➜  Network: use --host to expose
  ➜  press h to show help
```

✅ 前端启动成功！

---

## 🧪 功能测试清单

### 测试1: 登录功能
1. 打开浏览器访问 `http://localhost:3000`
2. 使用默认管理员账号登录：
   - 用户名: `admin`
   - 密码: `admin123`

**预期结果**: 成功进入管理员仪表盘

---

### 测试2: 创建基础数据

#### 2.1 创建学期
1. 点击侧边栏「学期管理」
2. 点击「创建学期」按钮
3. 填写信息：
   - 名称: 2023-2024学年第一学期
   - 学年: 2023-2024
   - 学期: 第一学期
   - 开始日期: 2023-09-01
   - 结束日期: 2024-01-31
4. 点击「确定」

**预期结果**: 学期创建成功，列表中显示新学期

#### 2.2 创建班级
1. 点击侧边栏「班级管理」
2. 点击「创建班级」
3. 填写信息：
   - 年级: 三年级
   - 班级名称: 一班
4. 点击「确定」

**预期结果**: 班级创建成功

#### 2.3 添加学生
1. 点击侧边栏「学生管理」
2. 点击「添加学生」
3. 填写信息：
   - 学号: 2024010001
   - 姓名: 张小明
   - 性别: 男
   - 班级: 三年级一班
4. 重复添加几个学生用于测试

**预期结果**: 学生添加成功

#### 2.4 创建评价指标
1. 点击侧边栏「指标管理」
2. 点击「添加指标」
3. 创建几个测试指标：
   - 语文成绩（分数类型，0-100）
   - 体育表现（等级类型：优秀/良好/及格）
   - 遵守纪律（布尔类型：是/否）

**预期结果**: 指标创建成功

---

### 测试3: 教师数据录入

#### 3.1 创建教师账号（管理员操作）
1. 学期管理 → 用户管理
2. 创建教师账号
3. 分配班级

#### 3.2 教师登录
1. 退出管理员账号
2. 使用教师账号登录

#### 3.3 在线录入测试
1. 点击侧边栏「数据录入」
2. 选择班级、学期、指标
3. 在表格中为学生填写评价数据
4. 点击「批量提交」

**预期结果**: 
- ✅ 成功提示
- ✅ 数据状态更新为"已保存"
- ✅ 统计数字更新

#### 3.4 Excel导入导出测试

**下载模板测试**:
1. 选择班级和指标
2. 点击「下载模板」按钮

**预期结果**: 下载Excel文件，包含学生信息和数据验证

**导入测试**:
1. 打开下载的Excel模板
2. 填写评价数据
3. 保存文件
4. 回到系统，点击「导入Excel」
5. 选择刚才填写的文件
6. 点击上传

**预期结果**: 
- ✅ 显示导入成功消息
- ✅ 显示成功/失败统计
- ✅ 表格自动刷新显示导入的数据

**导出报表测试**:
1. 确保已有评价数据
2. 点击「导出报表」按钮

**预期结果**: 下载Excel报表，包含完整的班级评价数据

---

### 测试4: AI评语生成

1. 点击侧边栏「评语管理」
2. 选择班级和学期
3. 点击单个学生的「生成」按钮

**预期结果**: 
- ✅ 显示"正在生成..."
- ✅ 几秒后显示生成的AI评语
- ✅ 状态更新为"草稿"

**批量生成测试**:
1. 点击「批量生成AI评语」按钮
2. 确认操作

**预期结果**: 
- ✅ 显示进度
- ✅ 显示成功统计
- ✅ 所有学生都有AI评语

**编辑测试**:
1. 点击某学生的「编辑」按钮
2. 在"教师评语"框中修改或新写评语
3. 点击「保存」

**预期结果**: ✅ 评语保存成功

**预览测试**:
1. 点击「预览」按钮
2. 查看AI评语和教师评语

**预期结果**: ✅ 显示完整评语

**导出测试**:
1. 点击「导出评语Excel」按钮

**预备结果**: ✅ 下载包含所有评语的Excel文件

---

### 测试5: 学生查询

1. 退出教师账号
2. 访问 `http://localhost:3000/student`
3. 输入学号和姓名
4. 点击「查询」

**预期结果**:
- ✅ 显示学生基本信息
- ✅ 显示评价数据表格
- ✅ 显示雷达图（如果有足够数据）
- ✅ 显示期末评语（如果已发布）

---

## 🐛 常见问题排查

### 问题1: 后端无法启动

**症状**: 启动后立即退出或报错

**排查步骤**:
```bash
# 检查Python依赖
pip list | grep fastapi
pip list | grep mysql-connector

# 如果缺少依赖
pip install -r requirements.txt

# 检查数据库连接（编辑 src/web/auth/dependencies.py）
```

### 问题2: 前端白屏

**症状**: 浏览器显示空白页

**排查步骤**:
```bash
# 检查前端依赖
cd frontend
npm install

# 检查控制台错误
# 按 F12 打开浏览器开发者工具 → Console标签

# 检查后端是否在运行
curl http://localhost:8000/docs
```

### 问题3: AI评语生成失败

**症状**: 点击生成后显示错误

**可能原因**:
1. 千问API密钥未配置或无效
2. 学生没有评价数据
3. 网络问题

**解决方法**:
```python
# 编辑 src/api/qwen_client.py
# 确保API_KEY正确
QWEN_API_KEY = "your_actual_api_key"
```

### 问题4: Excel导入失败

**症状**: 上传后显示错误

**可能原因**:
1. Excel格式不正确
2. 学号不匹配
3. 数据格式错误

**解决方法**:
- 使用系统下载的模板
- 确保学号与数据库中一致
- 检查错误提示中的详细信息

---

## ✅ 测试完成检查清单

> **最后更新**: 2026-01-22 (V2.0)

### 核心功能（已验证通过）
- [x] 管理员可以登录
- [x] 可以创建学期、班级、学生
- [x] 可以创建评价指标
- [x] 可以设置当前学期
- [x] 学期、班级、学生、教师可删除
- [x] 评价指标页面正常加载

### V2.0 新功能测试

#### 考试与成绩管理
- [ ] 可以创建考试（选择类型、科目、日期）
- [ ] 可以录入学生成绩
- [ ] 可以计算班级和年级排名
- [ ] 可以查看成绩统计（平均分、及格率等）
- [ ] 可以使用AI生成试卷分析

#### 考勤管理
- [ ] 可以按班级记录考勤
- [ ] 可以设置请假类型和原因
- [ ] 可以查看班级考勤统计
- [ ] 批量考勤录入正常

#### 数据大屏
- [ ] 访问 `/data-screen` 显示大屏
- [ ] 全校出勤数据正确
- [ ] 年级出勤率圆环图正常
- [ ] 点击年级显示班级详情

#### 数据导入导出
- [ ] 可以导出学生CSV
- [ ] 可以导入学生CSV
- [ ] 可以下载导入模板
- [ ] 可以导出成绩CSV
- [ ] 可以导入成绩CSV

#### 学生管理增强
- [ ] 可以转班学生
- [ ] 可以执行学年升级

#### 系统管理
- [ ] 可以创建数据库备份
- [ ] 可以查看备份列表

### 待测试功能（原有功能）
- [ ] 教师可以在线录入数据
- [ ] Excel模板下载正常
- [ ] Excel导入功能正常
- [ ] Excel导出功能正常
- [ ] 单个学生AI评语生成正常
- [ ] 批量AI评语生成正常
- [ ] 教师可以编辑评语
- [ ] 评语可以导出Excel
- [ ] 学生可以查询个人信息
- [ ] 学生可以看到雷达图
- [ ] 学生可以看到评语

---

## 📊 性能测试建议

### 小规模测试
- 班级: 1-2个
- 学生: 每班30-40人
- 指标: 5-10个
- 学期: 1个

### 压力测试
- 多个教师同时录入
- 批量生成100+学生评语
- 导入大批量Excel数据

---

## 🎯 测试后步骤

### 如果测试成功
1. ✅ 准备真实数据导入
2. ✅ 进行用户培训
3. ✅ 准备生产环境部署
4. ✅ 制定使用规范

### 如果发现问题
1. 📝 记录问题详情
2. 📝 提供错误截图
3. 📝 说明复现步骤
4. 📝 联系技术支持

---

## 💡 测试技巧

### 使用浏览器开发者工具
- **F12** 打开开发者工具
- **Network** 标签查看API请求
- **Console** 标签查看错误日志

### 查看后端日志
运行后端的终端窗口会显示所有API请求和错误信息

### 测试数据准备
建议准备一些测试数据：
- 3-5个班级
- 每班20-30个学生
- 5-8个评价指标
- 模拟真实评价场景

---

<div align="center">

**祝测试顺利！** 🎉

如有任何问题，请参考完整文档或联系技术支持。

</div>
